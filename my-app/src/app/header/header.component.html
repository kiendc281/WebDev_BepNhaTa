<div class="maincontainer">
  <div class="headerbar">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-md-6">
          <div class="slogan text-white">
            <img src="../../assets/header/ri-bowl-line.svg" alt="" />Bếp Nhà Ta
            - Chọn nguyên liệu chuẩn, nấu bữa cơm ngon!
          </div>
        </div>
        <div class="col-md-6">
          <div
            class="info d-flex justify-content-md-end justify-content-center"
          >
            <div class="info-item">
              <span class="number text-white">122</span>
              <span class="text text-white">Công thức</span>
            </div>
            <div class="info-item">
              <div class="number text-white">98</div>
              <div class="text text-white">Nguyên liệu</div>
            </div>
            <div class="info-item">
              <span class="number text-white">1,988</span>
              <span class="text text-white">Thành viên</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="nav">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-2 col-md-auto">
          <div class="logo"><img src="../../assets/logo.png" alt="logo" /></div>
        </div>

        <!-- Desktop menu -->
        <div class="col-md d-none d-md-block">
          <div class="nav-links">
            <a
              routerLink="/trang-chu"
              [class.active]="currentRoute === '/trang-chu'"
              >Trang chủ</a
            >
            <div class="dropdown">
              <a
                routerLink="/cong-thuc"
                class="dropdown-toggle"
                [class.active]="currentRoute.startsWith('/cong-thuc')"
                >Công thức</a
              >
              <div class="dropdown-content">
                <a
                  [routerLink]="['/cong-thuc']"
                  [queryParams]="{ region: null }"
                  >Tất cả</a
                >
                <a
                  [routerLink]="['/cong-thuc']"
                  [queryParams]="{ region: 'bac' }"
                  >Miền Bắc</a
                >
                <a
                  [routerLink]="['/cong-thuc']"
                  [queryParams]="{ region: 'trung' }"
                  >Miền Trung</a
                >
                <a
                  [routerLink]="['/cong-thuc']"
                  [queryParams]="{ region: 'nam' }"
                  >Miền Nam</a
                >
              </div>
            </div>
            <div class="dropdown">
              <a
                routerLink="/san-pham"
                class="dropdown-toggle"
                [class.active]="currentRoute.startsWith('/san-pham')"
                >Sản phẩm</a
              >
              <div class="dropdown-content">
                <a routerLink="/san-pham">Tất cả</a>
                <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-man'}">Món mặn</a>
                <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-xao'}">Món xào</a>
                <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-nuoc'}">Món nước</a>
                <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-tron'}">Món trộn</a>
              </div>
            </div>
            <a
              routerLink="/len-thuc-don"
              [class.active]="currentRoute === '/len-thuc-don'"
              >Lên thực đơn</a
            >
            <a routerLink="/blog" [class.active]="currentRoute === '/blog'"
              >Blog</a
            >
            <a
              routerLink="/cong-cu"
              [class.active]="currentRoute === '/cong-cu'"
              >Công cụ</a
            >
            <div class="dropdown">
              <a
                routerLink="/about-us"
                class="dropdown-toggle"
                [class.active]="
                  currentRoute.startsWith('/about-us') ||
                  currentRoute.startsWith('/chinh-sach') ||
                  currentRoute.startsWith('/faq') ||
                  currentRoute.startsWith('/lien-he')
                "
                >Giới thiệu</a
              >
              <div class="dropdown-content">
                <a routerLink="/about-us">Về chúng tôi</a>
                <a routerLink="/chinh-sach">Chính sách</a>
                <a routerLink="/faq">Câu hỏi thường gặp</a>
                <a routerLink="/lien-he">Liên hệ</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Search and Icons - Always visible -->
        <div class="col-auto ml-auto d-flex align-items-center nav-right">
          <div class="search-container">
            <input type="text" placeholder="Tìm kiếm" />
          </div>
          <a routerLink="/gio-hang" class="cart-icon">
            <img
              src="../../assets/header/mdi-cart-outline.svg"
              alt="Giỏ hàng"
            />
          </a>
          <img
            src="../../assets/header/group.svg"
            alt=""
            (click)="toggleLoginPopup()"
            class="user-icon"
            style="cursor: pointer"
          />

          <!-- Hamburger button - only visible on mobile -->
          <button class="hamburger-btn d-md-none" (click)="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
      </div>
    </div>
  </div>
  <hr class="hr-decor" />

  <!-- Mobile Menu -->
  <div class="mobile-menu" [class.active]="isMobileMenuOpen">
    <div class="mobile-nav-links">
      <a
        routerLink="/trang-chu"
        (click)="closeMobileMenu()"
        [class.active]="currentRoute === '/trang-chu'"
        >Trang chủ</a
      >
      <div
        class="mobile-dropdown"
        [class.active]="activeDropdown === 'congthuc'"
        [class.active-route]="currentRoute.startsWith('/cong-thuc')"
      >
        <div
          class="mobile-dropdown-toggle"
          (click)="toggleDropdown('congthuc', $event)"
        >
          Công thức <i class="dropdown-icon"></i>
        </div>
        <div class="mobile-dropdown-content">
          <a
            [routerLink]="['/cong-thuc']"
            [queryParams]="{ region: null }"
            (click)="closeMobileMenu()"
            >Tất cả</a
          >
          <a
            [routerLink]="['/cong-thuc']"
            [queryParams]="{ region: 'bac' }"
            (click)="closeMobileMenu()"
            >Miền Bắc</a
          >
          <a
            [routerLink]="['/cong-thuc']"
            [queryParams]="{ region: 'trung' }"
            (click)="closeMobileMenu()"
            >Miền Trung</a
          >
          <a
            [routerLink]="['/cong-thuc']"
            [queryParams]="{ region: 'nam' }"
            (click)="closeMobileMenu()"
            >Miền Nam</a
          >
        </div>
      </div>
      <div
        class="mobile-dropdown"
        [class.active]="activeDropdown === 'sanpham'"
        [class.active-route]="currentRoute.startsWith('/san-pham')"
      >
        <div
          class="mobile-dropdown-toggle"
          (click)="toggleDropdown('sanpham', $event)"
        >
          Sản phẩm <i class="dropdown-icon"></i>
        </div>
        <div class="mobile-dropdown-content">
          <a routerLink="/san-pham" (click)="closeMobileMenu()">Tất cả</a>
          <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-man'}" (click)="closeMobileMenu()">Món mặn</a>
          <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-xao'}" (click)="closeMobileMenu()">Món xào</a>
          <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-nuoc'}" (click)="closeMobileMenu()">Món nước</a>
          <a [routerLink]="['/san-pham']" [queryParams]="{category: 'mon-tron'}" (click)="closeMobileMenu()">Món trộn</a>
        </div>
      </div>
      <a
        routerLink="/len-thuc-don"
        (click)="closeMobileMenu()"
        [class.active]="currentRoute === '/len-thuc-don'"
        >Lên thực đơn</a
      >
      <a
        routerLink="/blog"
        (click)="closeMobileMenu()"
        [class.active]="currentRoute === '/blog'"
        >Blog</a
      >
      <a
        routerLink="/cong-cu"
        (click)="closeMobileMenu()"
        [class.active]="currentRoute === '/cong-cu'"
        >Công cụ</a
      >
      <div
        class="mobile-dropdown"
        [class.active]="activeDropdown === 'gioithieu'"
        [class.active-route]="
          currentRoute.startsWith('/about-us') ||
          currentRoute.startsWith('/chinh-sach') ||
          currentRoute.startsWith('/faq') ||
          currentRoute.startsWith('/lien-he')
        "
      >
        <div
          class="mobile-dropdown-toggle"
          (click)="toggleDropdown('gioithieu', $event)"
        >
          Giới thiệu <i class="dropdown-icon"></i>
        </div>
        <div class="mobile-dropdown-content">
          <a routerLink="/about-us" (click)="closeMobileMenu()">Về chúng tôi</a>
          <a routerLink="/chinh-sach" (click)="closeMobileMenu()">Chính sách</a>
          <a routerLink="/faq" (click)="closeMobileMenu()"
            >Câu hỏi thường gặp</a
          >
          <a routerLink="/lien-he" (click)="closeMobileMenu()">Liên hệ</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    class="mobile-menu-overlay"
    [class.active]="isMobileMenuOpen"
    (click)="closeMobileMenu()"
  ></div>
</div>

<!-- Login Popup -->
<div
  class="popup-overlay"
  *ngIf="showLoginPopup"
  (click)="closeLoginPopup($event)"
  (mousedown)="onMouseDown($event)"
>
  <div class="popup-content" (click)="$event.stopPropagation()">
    <app-dang-nhap
      *ngIf="currentForm === 'login'"
      (closePopup)="closeLoginPopup()"
      (switchToRegister)="switchToRegister()"
      (switchToForgotPass)="switchToForgotPass()"
    >
    </app-dang-nhap>

    <app-dang-ky
      *ngIf="currentForm === 'register'"
      (closePopup)="closeLoginPopup()"
      (switchToLogin)="switchToLogin()"
    >
    </app-dang-ky>

    <app-quen-mat-khau
      *ngIf="currentForm === 'forgot'"
      (closePopup)="closeLoginPopup()"
      (backToLogin)="switchToLogin()"
    >
    </app-quen-mat-khau>
  </div>
</div>
