<div class="container">
  <div class="row">
    <!-- Thanh toán form trái -->
    <div class="col-md-6 p-3">
      <h2>Thông tin thanh toán</h2>
      
      <div class="form-group mb-3">
        <label for="name">Họ và tên</label>
        <input type="text" class="form-control" id="name" [(ngModel)]="customerInfo.name">
      </div>
      
      <div class="form-group mb-3">
        <label for="phone">Số điện thoại</label>
        <input type="text" class="form-control" id="phone" [(ngModel)]="customerInfo.phone">
      </div>
      
      <div class="form-group mb-3">
        <label for="email">Email</label>
        <input type="email" class="form-control" id="email" [(ngModel)]="customerInfo.email">
      </div>
      
      <div class="form-group mb-3">
        <label for="address">Địa chỉ</label>
        <input type="text" class="form-control" id="address" [(ngModel)]="customerInfo.address">
      </div>
      
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="city">Thành phố/tỉnh</label>
          <select class="form-select" id="city" [(ngModel)]="customerInfo.city">
            <option selected disabled value="">Chọn...</option>
            <option value="hanoi">Hà Nội</option>
            <option value="hochiminh">TP. Hồ Chí Minh</option>
            <option value="danang">Đà Nẵng</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="district">Quận/huyện</label>
          <select class="form-select" id="district" [(ngModel)]="customerInfo.district">
            <option selected disabled value="">Chọn...</option>
            <option value="q1">Quận 1</option>
            <option value="q2">Quận 2</option>
            <option value="q3">Quận 3</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="ward">Phường/xã</label>
          <select class="form-select" id="ward" [(ngModel)]="customerInfo.ward">
            <option selected disabled value="">Chọn...</option>
            <option value="p1">Phường 1</option>
            <option value="p2">Phường 2</option>
            <option value="p3">Phường 3</option>
          </select>
        </div>
      </div>
      
      <div class="form-group mb-3">
        <label for="note">Ghi chú</label>
        <input type="text" class="form-control" id="note" placeholder="Ghi chú thêm (Ví dụ: giao giờ hành chính)" [(ngModel)]="customerInfo.note">
      </div>
      
      <div class="form-check mb-4">
        <input class="form-check-input" type="checkbox" id="saveAddress" [(ngModel)]="customerInfo.saveAddress">
        <label class="form-check-label" for="saveAddress">Lưu vào sổ địa chỉ để dùng cho lần mua hàng tiếp theo</label>
      </div>
      
      <h2>Hình thức thanh toán</h2>
      
      <div class="payment-methods">
        <div class="payment-method mb-2">
          <input type="radio" class="payment-radio" id="cod" name="payment-method" [checked]="paymentMethod === 'cod'" (change)="setPaymentMethod('cod')">
          <label for="cod" class="payment-label">
            <span class="payment-icon"><i class="bi bi-cash"></i></span>
            <span class="payment-text">COD</span>
          </label>
        </div>
        
        <div class="payment-method mb-2">
          <input type="radio" class="payment-radio" id="bank" name="payment-method" [checked]="paymentMethod === 'bank'" (change)="setPaymentMethod('bank')">
          <label for="bank" class="payment-label">
            <span class="payment-icon"><i class="bi bi-bank"></i></span>
            <span class="payment-text">Chuyển khoản ngân hàng</span>
          </label>
        </div>
      </div>
    </div>
    
    <!-- Giỏ hàng bên phải -->
    <div class="col-md-6 p-3 bg-light">
      <h2>Giỏ hàng</h2>
      
      <!-- Select all products -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="form-check">
          <input type="checkbox" class="form-check-input" id="selectAll" 
                 [checked]="allItemsSelected" 
                 (change)="toggleSelectAll()">
          <label class="form-check-label" for="selectAll">Tất cả sản phẩm</label>
          <span *ngIf="hasSelectedItems" class="ms-2 text-danger" role="button" (click)="removeSelectedItems()">Xóa sản phẩm</span>
        </div>
        <div class="d-flex">
          <div class="me-4">Số lượng</div>
          <div>Giá</div>
        </div>
      </div>
      
      <!-- Cart items -->
      <div class="cart-items">
        <div class="cart-item d-flex align-items-center py-2" *ngFor="let item of cartItems; let i = index">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="item-{{i}}" 
                   [(ngModel)]="item.selected" 
                   (change)="updateSelection()">
          </div>
          
          <div class="item-image ms-2">
            <img [src]="item.product.mainImage" [alt]="item.product.ingredientName" class="img-thumbnail" width="80">
          </div>
          
          <div class="item-details ms-2 flex-grow-1">
            <div class="item-name">{{ item.product.ingredientName }}</div>
            <div class="d-flex align-items-center remove-link">
              <span class="text-danger" role="button" (click)="removeItem(item)">Xóa</span>
            </div>
          </div>
          
          <div class="quantity-control d-flex align-items-center">
            <button class="btn btn-sm btn-quantity" (click)="updateQuantity(item, item.quantity - 1)">-</button>
            <span class="quantity mx-2">{{ item.quantity }}</span>
            <button class="btn btn-sm btn-quantity" (click)="updateQuantity(item, item.quantity + 1)">+</button>
          </div>
          
          <div class="item-price ms-3 text-end" width="80px">{{ item.price | number:'1.0-0' }} đ</div>
        </div>
      </div>
      
      <!-- Voucher -->
      <div class="voucher-section my-4">
        <div class="d-flex align-items-center">
          <label for="voucher" class="me-2">Voucher</label>
          <div class="voucher-input d-flex">
            <input type="text" class="form-control" id="voucher" placeholder="Nhập mã voucher" [(ngModel)]="discountCode">
            <button class="btn btn-outline-primary" (click)="applyVoucher()">Áp dụng</button>
          </div>
        </div>
      </div>
      
      <!-- Order summary -->
      <div class="order-summary mt-3">
        <div class="d-flex justify-content-between mb-2">
          <span>Tạm tính</span>
          <span>{{ total | number:'1.0-0' }} đ</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span>Giảm giá</span>
          <span>{{ discountAmount | number:'1.0-0' }} đ</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span>Phí giao hàng</span>
          <span>{{ shippingFee > 0 ? (shippingFee | number:'1.0-0') + ' đ' : 'Miễn phí' }}</span>
        </div>
        <div class="d-flex justify-content-between fw-bold pt-2 border-top">
          <span>Tổng</span>
          <span>{{ (total - discountAmount + shippingFee) | number:'1.0-0' }} đ</span>
        </div>
      </div>
      
      <!-- Footer info -->
      <div class="checkout-footer d-flex justify-content-between mt-4 align-items-center">
        <div class="d-flex align-items-center">
          <span class="me-2"><i class="bi bi-truck"></i></span>
          <span>COD thanh toán khi nhận hàng</span>
        </div>
        <div>
          <button class="btn btn-success" (click)="checkout()">THANH TOÁN</button>
        </div>
      </div>
    </div>
  </div>
</div>
