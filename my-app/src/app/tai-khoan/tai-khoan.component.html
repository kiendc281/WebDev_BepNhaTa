<div class="main-container">
  <div class="container">
    <div class="container-leftpanel">
      <button
        class="button-trang"
        (click)="showContent('thong-tin')"
        [ngClass]="{ active: selectedCategory === 'thong-tin' }"
      >
        <div class="button-content">
          <img
            [src]="
              selectedCategory === 'thong-tin'
                ? 'assets/tai-khoan/thongtintk-trang.svg'
                : 'assets/tai-khoan/thongtintk-cam.svg'
            "
            alt="arrow"
          />
          Thông tin tài khoản
        </div>
        <img
          [src]="
            selectedCategory === 'thong-tin'
              ? 'assets/faq/cuida-arrow-right-outline-trang.svg'
              : 'assets/faq/cuida-arrow-right-outline.svg'
          "
          alt="arrow"
        />
      </button>
      <button
        class="button-trang"
        (click)="showContent('lich-su')"
        [ngClass]="{ active: selectedCategory === 'lich-su' }"
      >
        <div class="button-content">
          <img
            [src]="
              selectedCategory === 'lich-su'
                ? 'assets/tai-khoan/lichsudonhang-trang.svg'
                : 'assets/tai-khoan/lichsudonhang-cam.svg'
            "
            alt="arrow"
          />
          Lịch sử đơn hàng
        </div>
        <img
          [src]="
            selectedCategory === 'lich-su'
              ? 'assets/faq/cuida-arrow-right-outline-trang.svg'
              : 'assets/faq/cuida-arrow-right-outline.svg'
          "
          alt="arrow"
        />
      </button>
      <button
        class="button-trang"
        [ngClass]="{ active: selectedCategory === 'yeu-thich' }"
        (click)="navigateToFavorites()"
      >
        <div class="button-content">
          <img
            [src]="
              selectedCategory === 'yeu-thich'
                ? 'assets/tai-khoan/heart-trang.svg'
                : 'assets/tai-khoan/heart-cam.svg'
            "
            alt="arrow"
          />
          Mục yêu thích
        </div>
        <img
          [src]="
            selectedCategory === 'yeu-thich'
              ? 'assets/faq/cuida-arrow-right-outline-trang.svg'
              : 'assets/faq/cuida-arrow-right-outline.svg'
          "
          alt="arrow"
        />
      </button>
      <button
        class="button-trang"
        (click)="showContent('so-dia-chi')"
        [ngClass]="{ active: selectedCategory === 'so-dia-chi' }"
      >
        <div class="button-content">
          <img
            [src]="
              selectedCategory === 'so-dia-chi'
                ? 'assets/tai-khoan/location-trang.svg'
                : 'assets/tai-khoan/location-cam.svg'
            "
            alt="sổ địa chỉ"
          />
          Sổ địa chỉ
        </div>
        <img
          [src]="
            selectedCategory === 'so-dia-chi'
              ? 'assets/faq/cuida-arrow-right-outline-trang.svg'
              : 'assets/faq/cuida-arrow-right-outline.svg'
          "
          alt="arrow"
        />
      </button>
      <button class="button-trang" (click)="logout()">
        <div class="button-content">
          <img
            [src]="
              selectedCategory === 'dang-xuat'
                ? 'assets/tai-khoan/dangxuat-trang.svg'
                : 'assets/tai-khoan/dangxuat-cam.svg'
            "
            alt="arrow"
          />
          Đăng xuất
        </div>
        <img
          [src]="
            selectedCategory === 'dang-xuat'
              ? 'assets/faq/cuida-arrow-right-outline-trang.svg'
              : 'assets/faq/cuida-arrow-right-outline.svg'
          "
          alt="arrow"
        />
      </button>
    </div>

    <!-- THÔNG TIN TÀI KHOẢN -->
    <div
      class="container-rightpanel"
      *ngIf="selectedCategory === 'thong-tin'"
      id="thong-tin"
    >
      <h1>THÔNG TIN TÀI KHOẢN</h1>
      <div class="thong-tin-tai-khoan">
        <div class="thong-tin-tai-khoan-item">
          <div class="thong-tin-tai-khoan-item-label">Họ và tên:</div>
          <span [ngClass]="{ 'not-updated': !currentUser?.name }">{{
            currentUser?.name || "Chưa cập nhật"
          }}</span>
        </div>
        <div class="thong-tin-tai-khoan-item">
          <div class="thong-tin-tai-khoan-item-label">Email:</div>
          <span [ngClass]="{ 'not-updated': !currentUser?.email }">{{
            currentUser?.email || "Chưa cập nhật"
          }}</span>
        </div>
        <div class="thong-tin-tai-khoan-item">
          <div class="thong-tin-tai-khoan-item-label">Số điện thoại:</div>
          <span [ngClass]="{ 'not-updated': !currentUser?.phone }">{{
            currentUser?.phone || "Chưa cập nhật"
          }}</span>
        </div>
        <div class="thong-tin-tai-khoan-item">
          <div class="thong-tin-tai-khoan-item-label">Giới tính:</div>
          <span [ngClass]="{ 'not-updated': !currentUser?.gender }">{{
            currentUser?.gender || "Chưa cập nhật"
          }}</span>
        </div>
        <div class="thong-tin-tai-khoan-item">
          <div class="thong-tin-tai-khoan-item-label">Ngày sinh:</div>
          <span [ngClass]="{ 'not-updated': !formatBirthDate() }">{{
            formatBirthDate() || "Chưa cập nhật"
          }}</span>
        </div>
        <button class="button-trang" (click)="openUpdateModal()">
          CẬP NHẬT
        </button>
      </div>
      <h1>THÔNG TIN ĐĂNG NHẬP</h1>
      <div class="thong-tin-tai-khoan-item">
        <div class="thong-tin-tai-khoan-item-label">Email:</div>
        <span [ngClass]="{ 'not-updated': !currentUser?.email }">{{
          currentUser?.email || "Chưa cập nhật"
        }}</span>
      </div>
      <div class="thong-tin-tai-khoan-item">
        <div class="thong-tin-tai-khoan-item-label">Mật khẩu:</div>
        <span>********</span>
      </div>
      <button class="button-trang" (click)="openPasswordModal()">
        CẬP NHẬT
      </button>
    </div>

    <!-- LỊCH SỬ ĐƠN HÀNG -->
    <div
      class="container-rightpanel"
      *ngIf="selectedCategory === 'lich-su'"
      id="lich-su"
    >
      <h1>LỊCH SỬ ĐƠN HÀNG</h1>
    </div>

    <!-- MỤC YÊU THÍCH -->
    <div
      class="container-rightpanel"
      *ngIf="selectedCategory === 'yeu-thich'"
      id="yeu-thich"
    >
      <h1>MỤC YÊU THÍCH</h1>
      <p>Chuyển hướng đến trang yêu thích...</p>
      <!-- Mục yêu thích đã được chuyển sang component riêng -->
    </div>

    <!-- Tab Sổ địa chỉ -->
    <div *ngIf="selectedCategory === 'so-dia-chi'" class="container-rightpanel">
      <h1>SỔ ĐỊA CHỈ</h1>
      <div class="my-4">
        <button (click)="openAddressModal()" class="button-cam">
          THÊM ĐỊA CHỈ MỚI
        </button>
      </div>

      <!-- Danh sách địa chỉ -->
      <div *ngIf="loadingAddresses" class="flex justify-center my-8">
        <div
          class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"
        ></div>
      </div>

      <div
        *ngIf="!loadingAddresses && userAddresses.length === 0"
        class="empty-state my-8 text-center"
      >
        <div class="text-gray-400 mb-4">
          <i class="fa fa-map-marker-alt text-4xl"></i>
        </div>
        <p class="text-gray-600">Bạn chưa có địa chỉ nào trong sổ địa chỉ</p>
        <button (click)="openAddressModal()" class="mt-4 button-cam">
          THÊM ĐỊA CHỈ MỚI
        </button>
      </div>

      <div
        *ngIf="!loadingAddresses && userAddresses.length > 0"
        class="address-list"
      >
        <div
          *ngFor="let address of userAddresses"
          class="address-item thong-tin-tai-khoan"
        >
          <div class="flex items-start justify-between">
            <div class="flex-1">
              <div class="thong-tin-tai-khoan-item">
                <div class="thong-tin-tai-khoan-item-label">Họ tên:</div>
                <span>{{ address.recipientName }}</span>
                <span *ngIf="address.isDefault" class="default-badge"
                  >Mặc định</span
                >
              </div>
              <div class="thong-tin-tai-khoan-item">
                <div class="thong-tin-tai-khoan-item-label">Số điện thoại:</div>
                <span>{{ address.recipientPhone }}</span>
              </div>
              <div class="thong-tin-tai-khoan-item" *ngIf="address.email">
                <div class="thong-tin-tai-khoan-item-label">Email:</div>
                <span>{{ address.email }}</span>
              </div>
              <div class="thong-tin-tai-khoan-item">
                <div class="thong-tin-tai-khoan-item-label">Địa chỉ:</div>
                <span>{{ formatAddress(address) }}</span>
              </div>
            </div>
            <div class="address-actions">
              <button
                *ngIf="!address.isDefault"
                (click)="setDefaultAddress(address._id)"
                class="button-trang"
              >
                ĐẶT MẶC ĐỊNH
              </button>
              <button
                (click)="openEditAddressModal(address)"
                class="button-trang"
              >
                CHỈNH SỬA
              </button>
              <button
                (click)="deleteAddress(address._id)"
                class="button-trang delete-btn"
              >
                XÓA
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Cập nhật thông tin tài khoản -->
<div class="modal-overlay" *ngIf="showUpdateModal">
  <div class="modal-container">
    <div class="modal-header">
      <h4>Chỉnh sửa thông tin tài khoản</h4>
      <button class="close-button" (click)="closeUpdateModal()">
        <img
          src="../../assets/tai-khoan/zondicons-close-outline.svg"
          alt="Đóng"
        />
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="updateForm" (ngSubmit)="updateUserInfo()">
        <!-- Họ và tên -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              updateForm.get('name')?.invalid && updateForm.get('name')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/hovaten.svg" alt="User" />
            Họ và tên của bạn:
          </label>
          <input
            type="text"
            formControlName="name"
            placeholder="Nhập họ và tên"
          />
          <div
            *ngIf="
              updateForm.get('name')?.invalid && updateForm.get('name')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="updateForm.get('name')?.hasError('required')"
              >Họ tên không được để trống</span
            >
          </div>
        </div>

        <!-- Email -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              updateForm.get('email')?.invalid &&
              updateForm.get('email')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/email.svg" alt="Email" />
            Email của bạn:
          </label>
          <input
            type="email"
            formControlName="email"
            placeholder="Nhập email"
          />
          <div
            *ngIf="
              updateForm.get('email')?.invalid &&
              updateForm.get('email')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="updateForm.get('email')?.hasError('required')"
              >Email không được để trống</span
            >
            <span *ngIf="updateForm.get('email')?.hasError('email')"
              >Email không hợp lệ</span
            >
          </div>
        </div>

        <!-- Số điện thoại -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              updateForm.get('phone')?.invalid &&
              updateForm.get('phone')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/phone.svg" alt="Phone" />
            Số điện thoại
          </label>
          <input
            type="tel"
            formControlName="phone"
            placeholder="Nhập số điện thoại"
          />
          <div
            *ngIf="
              updateForm.get('phone')?.invalid &&
              updateForm.get('phone')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="updateForm.get('phone')?.hasError('required')"
              >Số điện thoại không được để trống</span
            >
            <span *ngIf="updateForm.get('phone')?.hasError('pattern')"
              >Số điện thoại phải có 10 chữ số</span
            >
          </div>
        </div>

        <!-- Ngày sinh -->
        <div class="form-group">
          <label>
            <img src="../../assets/tai-khoan/dob.svg" alt="Birthday" />
            Ngày sinh của bạn
          </label>
          <div class="birthday-select">
            <div class="select-container">
              <select formControlName="day">
                <option *ngFor="let day of days" [value]="day">
                  Ngày {{ day }}
                </option>
              </select>
              <img
                src="../../assets/tai-khoan/icon-down.svg"
                alt="Dropdown"
                class="dropdown-icon"
              />
            </div>
            <div class="select-container">
              <select formControlName="month">
                <option *ngFor="let month of months" [value]="month">
                  Tháng {{ month }}
                </option>
              </select>
              <img
                src="../../assets/tai-khoan/icon-down.svg"
                alt="Dropdown"
                class="dropdown-icon"
              />
            </div>
            <div class="select-container">
              <select formControlName="year">
                <option *ngFor="let year of years" [value]="year">
                  Năm {{ year }}
                </option>
              </select>
              <img
                src="../../assets/tai-khoan/icon-down.svg"
                alt="Dropdown"
                class="dropdown-icon"
              />
            </div>
          </div>
        </div>

        <!-- Giới tính -->
        <div class="form-group">
          <div class="gender-options">
            <label class="radio-container">
              <input
                type="radio"
                formControlName="gender"
                value="Nam"
                [checked]="gender === 'Nam'"
                (change)="selectGender('Nam')"
              />
              <span class="radio-label">Nam</span>
            </label>
            <label class="radio-container">
              <input
                type="radio"
                formControlName="gender"
                value="Nữ"
                [checked]="gender === 'Nữ'"
                (change)="selectGender('Nữ')"
              />
              <span class="radio-label">Nữ</span>
            </label>
            <label class="radio-container">
              <input
                type="radio"
                formControlName="gender"
                value="Khác"
                [checked]="gender === 'Khác'"
                (change)="selectGender('Khác')"
              />
              <span class="radio-label">Khác</span>
            </label>
          </div>
        </div>

        <!-- Nút cập nhật -->
        <button type="submit" class="button-cam">CẬP NHẬT</button>
      </form>
    </div>
  </div>
</div>

<!-- Modal Cập nhật thông tin đăng nhập (mật khẩu) -->
<div class="modal-overlay" *ngIf="showPasswordModal">
  <div class="modal-container">
    <div class="modal-header">
      <h4>Chỉnh sửa thông tin đăng nhập</h4>
      <button class="close-button" (click)="closePasswordModal()">
        <img
          src="../../assets/tai-khoan/zondicons-close-outline.svg"
          alt="Đóng"
        />
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="passwordForm" (ngSubmit)="updatePassword()">
        <!-- Mật khẩu cũ -->
        <div
          class="form-group password-field"
          [ngClass]="{
            'has-error':
              passwordForm.get('oldPassword')?.invalid &&
              passwordForm.get('oldPassword')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/lock.svg" alt="Password" />
            Mật khẩu cũ
          </label>
          <div class="password-input-container">
            <input
              [type]="showOldPassword ? 'text' : 'password'"
              formControlName="oldPassword"
              placeholder="Nhập mật khẩu cũ"
            />
            <img
              [src]="
                showOldPassword
                  ? '../../assets/tai-khoan/unhide.svg'
                  : '../../assets/tai-khoan/hideeye.svg'
              "
              alt="Toggle"
              class="toggle-password"
              (click)="togglePasswordVisibility('old')"
            />
          </div>
          <div
            *ngIf="
              passwordForm.get('oldPassword')?.invalid &&
              passwordForm.get('oldPassword')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="passwordForm.get('oldPassword')?.hasError('required')"
              >Vui lòng nhập mật khẩu cũ</span
            >
          </div>
        </div>

        <!-- Mật khẩu mới -->
        <div
          class="form-group password-field"
          [ngClass]="{
            'has-error':
              passwordForm.get('newPassword')?.invalid &&
              passwordForm.get('newPassword')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/lock.svg" alt="Password" />
            Mật khẩu mới
          </label>
          <div class="password-input-container">
            <input
              [type]="showNewPassword ? 'text' : 'password'"
              formControlName="newPassword"
              placeholder="Nhập mật khẩu mới"
            />
            <img
              [src]="
                showNewPassword
                  ? '../../assets/tai-khoan/unhide.svg'
                  : '../../assets/tai-khoan/hideeye.svg'
              "
              alt="Toggle"
              class="toggle-password"
              (click)="togglePasswordVisibility('new')"
            />
          </div>
          <div
            *ngIf="
              passwordForm.get('newPassword')?.invalid &&
              passwordForm.get('newPassword')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="passwordForm.get('newPassword')?.hasError('required')"
              >Vui lòng nhập mật khẩu mới</span
            >
            <span *ngIf="passwordForm.get('newPassword')?.hasError('minlength')"
              >Mật khẩu phải có ít nhất 8 ký tự</span
            >
            <span
              *ngIf="
                passwordForm.get('newPassword')?.hasError('strongPassword')
              "
              >Mật khẩu phải bao gồm chữ in hoa, số và ký tự đặc biệt</span
            >
          </div>
          <div class="mt-2 small">
            <ul>
              <li>Tối thiểu 8 ký tự</li>
              <li>Bao gồm chữ in hoa, số và ký tự đặc biệt</li>
            </ul>
          </div>
        </div>

        <!-- Xác nhận mật khẩu mới -->
        <div
          class="form-group password-field"
          [ngClass]="{
            'has-error':
              passwordForm.get('confirmPassword')?.invalid &&
              passwordForm.get('confirmPassword')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/lock.svg" alt="Password" />
            Xác nhận mật khẩu mới
          </label>
          <div class="password-input-container">
            <input
              [type]="showConfirmPassword ? 'text' : 'password'"
              formControlName="confirmPassword"
              placeholder="Xác nhận mật khẩu mới"
            />
            <img
              [src]="
                showConfirmPassword
                  ? '../../assets/tai-khoan/unhide.svg'
                  : '../../assets/tai-khoan/hideeye.svg'
              "
              alt="Toggle"
              class="toggle-password"
              (click)="togglePasswordVisibility('confirm')"
            />
          </div>
          <div
            *ngIf="
              passwordForm.get('confirmPassword')?.invalid &&
              passwordForm.get('confirmPassword')?.touched
            "
            class="validation-error"
          >
            <span
              *ngIf="passwordForm.get('confirmPassword')?.hasError('required')"
              >Vui lòng xác nhận mật khẩu mới</span
            >
            <span
              *ngIf="passwordForm.get('confirmPassword')?.hasError('noMatch')"
              >Mật khẩu xác nhận không khớp</span
            >
          </div>
        </div>

        <!-- Nút cập nhật -->
        <button type="submit" class="button-cam">CẬP NHẬT</button>
      </form>
    </div>
  </div>
</div>

<!-- Modal thêm địa chỉ mới -->
<div *ngIf="showAddressModal" class="modal-overlay">
  <div class="modal-container">
    <div class="modal-header">
      <h4>Thêm địa chỉ mới</h4>
      <button class="close-button" (click)="closeAddressModal()">
        <img
          src="../../assets/tai-khoan/zondicons-close-outline.svg"
          alt="Đóng"
        />
      </button>
    </div>

    <div class="modal-body">
      <form [formGroup]="addressForm" (ngSubmit)="addNewAddress()">
        <!-- Tên người nhận -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('recipientName')?.invalid &&
              addressForm.get('recipientName')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/hovaten.svg" alt="User" />
            Họ tên người nhận:
          </label>
          <input
            type="text"
            formControlName="recipientName"
            placeholder="Nhập họ tên người nhận"
          />
          <div
            *ngIf="
              addressForm.get('recipientName')?.invalid &&
              addressForm.get('recipientName')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('recipientName')?.hasError('required')"
              >Vui lòng nhập họ tên người nhận</span
            >
          </div>
        </div>

        <!-- Số điện thoại -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('recipientPhone')?.invalid &&
              addressForm.get('recipientPhone')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/phone.svg" alt="Phone" />
            Số điện thoại:
          </label>
          <input
            type="tel"
            formControlName="recipientPhone"
            placeholder="Nhập số điện thoại"
          />
          <div
            *ngIf="
              addressForm.get('recipientPhone')?.invalid &&
              addressForm.get('recipientPhone')?.touched
            "
            class="validation-error"
          >
            <span
              *ngIf="addressForm.get('recipientPhone')?.hasError('required')"
              >Vui lòng nhập số điện thoại</span
            >
            <span *ngIf="addressForm.get('recipientPhone')?.hasError('pattern')"
              >Số điện thoại phải có 10 chữ số</span
            >
          </div>
        </div>

        <!-- Email -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('email')?.invalid &&
              addressForm.get('email')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/email.svg" alt="Email" />
            Email:
          </label>
          <input
            type="email"
            formControlName="email"
            placeholder="Nhập email"
          />
          <div
            *ngIf="
              addressForm.get('email')?.invalid &&
              addressForm.get('email')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('email')?.hasError('email')"
              >Vui lòng nhập email hợp lệ</span
            >
          </div>
        </div>

        <!-- Tỉnh/Thành phố -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('province')?.invalid &&
              addressForm.get('province')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Tỉnh/Thành phố:
          </label>
          <input
            type="text"
            formControlName="province"
            placeholder="Nhập tỉnh/thành phố"
          />
          <div
            *ngIf="
              addressForm.get('province')?.invalid &&
              addressForm.get('province')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('province')?.hasError('required')"
              >Vui lòng nhập tỉnh/thành phố</span
            >
          </div>
        </div>

        <!-- Quận/Huyện -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('district')?.invalid &&
              addressForm.get('district')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Quận/Huyện:
          </label>
          <input
            type="text"
            formControlName="district"
            placeholder="Nhập quận/huyện"
          />
          <div
            *ngIf="
              addressForm.get('district')?.invalid &&
              addressForm.get('district')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('district')?.hasError('required')"
              >Vui lòng nhập quận/huyện</span
            >
          </div>
        </div>

        <!-- Phường/Xã -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('ward')?.invalid &&
              addressForm.get('ward')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Phường/Xã:
          </label>
          <input
            type="text"
            formControlName="ward"
            placeholder="Nhập phường/xã"
          />
          <div
            *ngIf="
              addressForm.get('ward')?.invalid &&
              addressForm.get('ward')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('ward')?.hasError('required')"
              >Vui lòng nhập phường/xã</span
            >
          </div>
        </div>

        <!-- Địa chỉ cụ thể -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('detail')?.invalid &&
              addressForm.get('detail')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Địa chỉ cụ thể:
          </label>
          <input
            type="text"
            formControlName="detail"
            placeholder="Nhập số nhà, tên đường,..."
          />
          <div
            *ngIf="
              addressForm.get('detail')?.invalid &&
              addressForm.get('detail')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('detail')?.hasError('required')"
              >Vui lòng nhập địa chỉ cụ thể</span
            >
          </div>
        </div>

        <!-- Đặt làm mặc định -->
        <div class="form-group">
          <div class="gender-options">
            <label class="radio-container">
              <input type="checkbox" formControlName="isDefault" />
              <span class="radio-label">Đặt làm địa chỉ mặc định</span>
            </label>
          </div>
        </div>

        <!-- Nút thêm -->
        <button type="submit" class="button-cam">THÊM ĐỊA CHỈ</button>
      </form>
    </div>
  </div>
</div>

<!-- Modal chỉnh sửa địa chỉ -->
<div *ngIf="showEditAddressModal" class="modal-overlay">
  <div class="modal-container">
    <div class="modal-header">
      <h4>Chỉnh sửa địa chỉ</h4>
      <button class="close-button" (click)="closeEditAddressModal()">
        <img
          src="../../assets/tai-khoan/zondicons-close-outline.svg"
          alt="Đóng"
        />
      </button>
    </div>

    <div class="modal-body">
      <form [formGroup]="addressForm" (ngSubmit)="updateAddress()">
        <!-- Tên người nhận -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('recipientName')?.invalid &&
              addressForm.get('recipientName')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/hovaten.svg" alt="User" />
            Họ tên người nhận:
          </label>
          <input
            type="text"
            formControlName="recipientName"
            placeholder="Nhập họ tên người nhận"
          />
          <div
            *ngIf="
              addressForm.get('recipientName')?.invalid &&
              addressForm.get('recipientName')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('recipientName')?.hasError('required')"
              >Vui lòng nhập họ tên người nhận</span
            >
          </div>
        </div>

        <!-- Số điện thoại -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('recipientPhone')?.invalid &&
              addressForm.get('recipientPhone')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/phone.svg" alt="Phone" />
            Số điện thoại:
          </label>
          <input
            type="tel"
            formControlName="recipientPhone"
            placeholder="Nhập số điện thoại"
          />
          <div
            *ngIf="
              addressForm.get('recipientPhone')?.invalid &&
              addressForm.get('recipientPhone')?.touched
            "
            class="validation-error"
          >
            <span
              *ngIf="addressForm.get('recipientPhone')?.hasError('required')"
              >Vui lòng nhập số điện thoại</span
            >
            <span *ngIf="addressForm.get('recipientPhone')?.hasError('pattern')"
              >Số điện thoại phải có 10 chữ số</span
            >
          </div>
        </div>

        <!-- Email -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('email')?.invalid &&
              addressForm.get('email')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/email.svg" alt="Email" />
            Email:
          </label>
          <input
            type="email"
            formControlName="email"
            placeholder="Nhập email"
          />
          <div
            *ngIf="
              addressForm.get('email')?.invalid &&
              addressForm.get('email')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('email')?.hasError('email')"
              >Vui lòng nhập email hợp lệ</span
            >
          </div>
        </div>

        <!-- Tỉnh/Thành phố -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('province')?.invalid &&
              addressForm.get('province')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Tỉnh/Thành phố:
          </label>
          <input
            type="text"
            formControlName="province"
            placeholder="Nhập tỉnh/thành phố"
          />
          <div
            *ngIf="
              addressForm.get('province')?.invalid &&
              addressForm.get('province')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('province')?.hasError('required')"
              >Vui lòng nhập tỉnh/thành phố</span
            >
          </div>
        </div>

        <!-- Quận/Huyện -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('district')?.invalid &&
              addressForm.get('district')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Quận/Huyện:
          </label>
          <input
            type="text"
            formControlName="district"
            placeholder="Nhập quận/huyện"
          />
          <div
            *ngIf="
              addressForm.get('district')?.invalid &&
              addressForm.get('district')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('district')?.hasError('required')"
              >Vui lòng nhập quận/huyện</span
            >
          </div>
        </div>

        <!-- Phường/Xã -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('ward')?.invalid &&
              addressForm.get('ward')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Phường/Xã:
          </label>
          <input
            type="text"
            formControlName="ward"
            placeholder="Nhập phường/xã"
          />
          <div
            *ngIf="
              addressForm.get('ward')?.invalid &&
              addressForm.get('ward')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('ward')?.hasError('required')"
              >Vui lòng nhập phường/xã</span
            >
          </div>
        </div>

        <!-- Địa chỉ cụ thể -->
        <div
          class="form-group"
          [ngClass]="{
            'has-error':
              addressForm.get('detail')?.invalid &&
              addressForm.get('detail')?.touched
          }"
        >
          <label>
            <img src="../../assets/tai-khoan/location-cam.svg" alt="Location" />
            Địa chỉ cụ thể:
          </label>
          <input
            type="text"
            formControlName="detail"
            placeholder="Nhập số nhà, tên đường,..."
          />
          <div
            *ngIf="
              addressForm.get('detail')?.invalid &&
              addressForm.get('detail')?.touched
            "
            class="validation-error"
          >
            <span *ngIf="addressForm.get('detail')?.hasError('required')"
              >Vui lòng nhập địa chỉ cụ thể</span
            >
          </div>
        </div>

        <!-- Đặt làm mặc định -->
        <div class="form-group">
          <div class="gender-options">
            <label class="radio-container">
              <input type="checkbox" formControlName="isDefault" />
              <span class="radio-label">Đặt làm địa chỉ mặc định</span>
            </label>
          </div>
        </div>

        <!-- Nút cập nhật -->
        <button type="submit" class="button-cam">CẬP NHẬT</button>
      </form>
    </div>
  </div>
</div>

<!-- Toast Notification Container -->
<div class="toast-container">
  <div
    *ngFor="let toast of toasts; let i = index"
    class="toast-message"
    [ngClass]="toast.type === 'success' ? 'toast-success' : 'toast-error'"
    [class.toast-fadeout]="toast.fading"
  >
    <div class="toast-icon">
      <img
        *ngIf="toast.type === 'success'"
        src="../../assets/tai-khoan/lets-icons-check-fill.svg"
        alt="Success"
      />
      <img
        *ngIf="toast.type === 'error'"
        src="../../assets/tai-khoan/material-symbols-error-outline.svg"
        alt="Error"
      />
    </div>
    <div class="toast-content">
      <div class="toast-title">{{ toast.title }}</div>
      <div class="toast-body">{{ toast.message }}</div>
    </div>
    <button class="toast-close" (click)="removeToast(i)">×</button>
  </div>
</div>
